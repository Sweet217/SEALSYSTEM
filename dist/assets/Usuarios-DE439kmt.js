import{o as t,e as l,b as f,a as o,F as v,k as h,f as b,m as i,y as n,A as d,g as m,t as u,z as c}from"./app-B3E4MCWe.js";import{N as U,F as _}from"./FooterComponent-MxrKtEt9.js";import"./SOLYTEC LOGO-D994yKaO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const w={class:"container mx-auto mt-4"},C=o("h1",{class:"text-2xl font-bold mb-4"},"Todos los Usuarios",-1),y={key:0,class:"text-gray-500"},S={key:1},V={class:"list-disc space-y-2"},E={class:"flex items-center justify-between"},M={class:"flex space-x-2"},k=["onClick"],A=["onClick"],P=["onClick"],g={key:2,class:"modal"},N={class:"modal-content"},O=o("h2",null,"Editar Usuario",-1),$=o("label",{for:"edit-nombre"},"Nombre:",-1),T=o("label",{for:"edit-email"},"Correo Electrónico:",-1),F=o("label",{for:"edit-telefono"},"Teléfono:",-1),D=o("label",{for:"edit-estado"},"Estado:",-1),z=o("option",{value:"Activo"},"Activo",-1),I=o("option",{value:"Inactivo"},"Inactivo",-1),j=[z,I],B=o("label",{for:"edit-tipo_usuario"},"Rol:",-1),L=o("option",{value:"Administrador"},"Administrador",-1),R=o("option",{value:"Operador"},"Operador",-1),Z=[L,R],G=o("div",{class:"text-center"},[o("button",{type:"submit"},"Guardar Cambios")],-1),q={key:3,class:"modal"},H={class:"modal-content"},J=o("h2",null,"Crear Nuevo Usuario",-1),K={key:0,class:"error-message"},Q=o("label",{for:"crear-nombre"},"Nombre:",-1),W=o("label",{for:"crear-email"},"Correo Electrónico:",-1),X=o("label",{for:"crear-password"},"Contraseña:",-1),Y=o("label",{for:"crear-confirmPassword"},"Confirmar Contraseña:",-1),x=o("label",{for:"crear-telefono"},"Teléfono:",-1),oo=o("label",{for:"crear-estado"},"Estado:",-1),eo=o("option",{value:"Activo"},"Activo",-1),ro=o("option",{value:"Inactivo"},"Inactivo",-1),so=[eo,ro],ao=o("label",{for:"crear-tipo_usuario"},"Rol:",-1),io=o("option",{value:"Administrador"},"Administrador",-1),to=o("option",{value:"Operador"},"Operador",-1),lo=[io,to],no=o("div",{class:"text-center"},[o("button",{type:"submit"},"Guardar Cambios")],-1),uo={data(){return{modalVisible:!1,crearModalVisible:!1,usuarioSeleccionado:{user_id:"",nombre:"",email:"",telefono:"",estado:"",tipo_usuario:""},nuevoUsuario:{nombre:"",email:"",password:"",confirmPassword:"",tipo_usuario:"Operador",telefono:"",estado:"Activo"},nombreUsuario:"",tipoUsuario:"",error:""}},mounted(){c.get("/api/usuario_actual").then(a=>{this.nombreUsuario=a.data.nombre,this.tipoUsuario=a.data.tipo_usuario}).catch(a=>{console.error("Error al obtener el usuario actual:",a),a.response&&a.response.status===401?window.location.href="/":this.error="Error al obtener el usuario actual."})},methods:{abrirCrearModal(){this.crearModalVisible=!0,this.resetForm()},cerrarCrearModal(){this.crearModalVisible=!1,this.resetForm()},resetForm(){this.nuevoUsuario={nombre:"",email:"",password:"",confirmPassword:"",tipo_usuario:"Operador",telefono:"",estado:"Activo"}},abrirModal(a){this.usuarioSeleccionado={...a},this.modalVisible=!0},cerrarModal(){this.modalVisible=!1,this.usuarioSeleccionado={user_id:null,nombre:"",email:"",telefono:"",estado:"",tipo_usuario:""}},verDispositivosUsuario(a){window.location.href=`/equipos_usuario_pagina/${a}`},eliminarUsuario(a){c.delete(`/usuariosDELETE/${a}`).then(()=>{alert("Usuario eliminado correctamente"),window.location.reload()}).catch(e=>{console.error("Error al eliminar el usuario:",e),alert("Error al eliminar el usuario")})},editarUsuario(a){c.put(`/usuariosPUT/${a}`,{nombre:this.usuarioSeleccionado.nombre,email:this.usuarioSeleccionado.email,telefono:this.usuarioSeleccionado.telefono,estado:this.usuarioSeleccionado.estado,tipo_usuario:this.usuarioSeleccionado.tipo_usuario}).then(()=>{alert("Usuario editado correctamente"),this.cerrarModal(),window.location.reload()}).catch(e=>{console.error("Error al editar el usuario:",e),alert("Error al editar el usuario")})},async crearUsuario(){if(!this.nuevoUsuario.nombre||!this.nuevoUsuario.email||!this.nuevoUsuario.password||!this.nuevoUsuario.confirmPassword||!this.nuevoUsuario.telefono||!this.nuevoUsuario.estado||!this.nuevoUsuario.tipo_usuario){this.error="Por favor completa todos los campos.";return}if(this.nuevoUsuario.password!==this.nuevoUsuario.confirmPassword){this.error="Las contraseñas no coinciden.";return}if(!/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/.test(this.nuevoUsuario.email)){this.error="Por favor ingresa un correo electrónico válido.";return}if(!/^\d+(\s\d+)*$/.test(this.nuevoUsuario.telefono)){this.error="El teléfono debe contener solo números y espacios";return}if(!/^\d{3}\s\d{3}\s\d{4}$/.test(this.nuevoUsuario.telefono)){this.error="El teléfono debe tener el formato 000 000 0000.";return}try{const a=await c.post("/signupPOST",{nombre:this.nuevoUsuario.nombre,email:this.nuevoUsuario.email,password:this.nuevoUsuario.password,password_confirmation:this.nuevoUsuario.confirmPassword,tipo_usuario:this.nuevoUsuario.tipo_usuario,telefono:this.nuevoUsuario.telefono,estado:this.nuevoUsuario.estado});alert("Usuario creado correctamente"),this.cerrarCrearModal(),window.location.reload()}catch(a){console.error("Error al crear el usuario:",a.response.data),this.error="Error al crear el usuario",alert("Error al crear el usuario")}}}},vo=Object.assign(uo,{__name:"Usuarios",props:{usuarios:Object},setup(a){return(e,s)=>(t(),l(v,null,[f(U),o("div",w,[C,o("button",{class:"btn morado-btn",onClick:s[0]||(s[0]=(...r)=>e.abrirCrearModal&&e.abrirCrearModal(...r))},"Crear Nuevo Usuario"),a.usuarios.length===0?(t(),l("div",y," No hay usuarios disponibles. ")):(t(),l("div",S,[o("ul",V,[(t(!0),l(v,null,h(a.usuarios,r=>(t(),l("li",{key:r.user_id},[o("div",E,[o("div",null,[o("h3",null,"Nombre: "+u(r.nombre),1),o("p",null,"Correo Electrónico: "+u(r.email),1),o("p",null,"Teléfono: "+u(r.telefono),1),o("p",null,"Estado: "+u(r.estado),1),o("p",null,"Rol: "+u(r.tipo_usuario),1)]),o("div",M,[o("button",{class:"btn ver-dispositivos-btn",onClick:p=>e.verDispositivosUsuario(r.user_id)},"Ver Dispositivos",8,k),o("button",{class:"btn editar-btn",onClick:p=>e.abrirModal(r)},"Editar",8,A),o("button",{class:"btn eliminar-btn btn-danger btn-trash bi-trash",onClick:p=>e.eliminarUsuario(r.user_id)},null,8,P)])])]))),128))])])),e.modalVisible?(t(),l("div",g,[o("div",N,[o("span",{class:"close",onClick:s[1]||(s[1]=(...r)=>e.cerrarModal&&e.cerrarModal(...r))},"×"),O,o("form",{onSubmit:s[7]||(s[7]=b(r=>e.editarUsuario(e.usuarioSeleccionado.user_id),["prevent"]))},[$,i(o("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=r=>e.usuarioSeleccionado.nombre=r),name:"edit-nombre",class:"form-control rounded-pill",autocomplete:"off"},null,512),[[n,e.usuarioSeleccionado.nombre]]),T,i(o("input",{type:"email","onUpdate:modelValue":s[3]||(s[3]=r=>e.usuarioSeleccionado.email=r),name:"edit-email",class:"form-control rounded-pill",autocomplete:"off"},null,512),[[n,e.usuarioSeleccionado.email]]),F,i(o("input",{type:"tel","onUpdate:modelValue":s[4]||(s[4]=r=>e.usuarioSeleccionado.telefono=r),name:"edit-telefono",class:"form-control rounded-pill",autocomplete:"off"},null,512),[[n,e.usuarioSeleccionado.telefono]]),D,i(o("select",{"onUpdate:modelValue":s[5]||(s[5]=r=>e.usuarioSeleccionado.estado=r),name:"edit-estado",class:"form-select rounded-pill"},j,512),[[d,e.usuarioSeleccionado.estado]]),B,i(o("select",{"onUpdate:modelValue":s[6]||(s[6]=r=>e.usuarioSeleccionado.tipo_usuario=r),name:"edit-tipo_usuario",class:"form-select rounded-pill"},Z,512),[[d,e.usuarioSeleccionado.tipo_usuario]]),G],32)])])):m("",!0),e.crearModalVisible?(t(),l("div",q,[o("div",H,[o("span",{class:"close",onClick:s[8]||(s[8]=(...r)=>e.cerrarCrearModal&&e.cerrarCrearModal(...r))},"×"),J,e.error?(t(),l("div",K,u(e.error),1)):m("",!0),o("form",{onSubmit:s[16]||(s[16]=b((...r)=>e.crearUsuario&&e.crearUsuario(...r),["prevent"])),autocomplete:"off"},[Q,i(o("input",{type:"text","onUpdate:modelValue":s[9]||(s[9]=r=>e.nuevoUsuario.nombre=r),name:"crear-nombre",class:"form-control rounded-pill",autocomplete:"off"},null,512),[[n,e.nuevoUsuario.nombre]]),W,i(o("input",{type:"email","onUpdate:modelValue":s[10]||(s[10]=r=>e.nuevoUsuario.email=r),name:"crear-email",class:"form-control rounded-pill",autocomplete:"off"},null,512),[[n,e.nuevoUsuario.email]]),X,i(o("input",{type:"password","onUpdate:modelValue":s[11]||(s[11]=r=>e.nuevoUsuario.password=r),name:"crear-password",class:"form-control rounded-pill",autocomplete:"new-password"},null,512),[[n,e.nuevoUsuario.password]]),Y,i(o("input",{type:"password","onUpdate:modelValue":s[12]||(s[12]=r=>e.nuevoUsuario.confirmPassword=r),name:"crear-confirmPassword",class:"form-control rounded-pill",autocomplete:"new-password"},null,512),[[n,e.nuevoUsuario.confirmPassword]]),x,i(o("input",{type:"tel","onUpdate:modelValue":s[13]||(s[13]=r=>e.nuevoUsuario.telefono=r),name:"crear-telefono",class:"form-control rounded-pill",autocomplete:"off"},null,512),[[n,e.nuevoUsuario.telefono]]),oo,i(o("select",{"onUpdate:modelValue":s[14]||(s[14]=r=>e.nuevoUsuario.estado=r),name:"crear-estado",class:"form-select rounded-pill"},so,512),[[d,e.nuevoUsuario.estado]]),ao,i(o("select",{"onUpdate:modelValue":s[15]||(s[15]=r=>e.nuevoUsuario.tipo_usuario=r),name:"crear-tipo_usuario",class:"form-select rounded-pill"},lo,512),[[d,e.nuevoUsuario.tipo_usuario]]),no],32)])])):m("",!0)]),f(_)],64))}});export{vo as default};
