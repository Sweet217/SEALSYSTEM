import{o as r,e as a,b as c,a as e,F as d,k as m,f as b,m as u,y as p,A as f,g as h,z as n,t as _}from"./app-B3E4MCWe.js";import{N as v,F as C}from"./FooterComponent-MxrKtEt9.js";import"./SOLYTEC LOGO-D994yKaO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"container mx-auto mt-4"},q=e("h1",{class:"text-2xl font-bold mb-4"},"Todas las Listas",-1),k={key:0,class:"text-gray-500"},S={key:1},y={class:"list-disc space-y-2"},N={class:"flex items-center justify-between"},M=["onClick"],V={class:"flex space-x-2"},w=["onClick"],E=["onClick"],U={key:0,class:"modal"},g={class:"modal-content"},T=e("h2",null,"Editar Lista",-1),$=e("label",{for:"nombre"},"Nombre:",-1),D=e("div",{class:"text-center"},[e("button",{type:"submit"},"Guardar Cambios")],-1),j={key:2,class:"modal"},F={class:"modal-content"},O=e("h2",null,"Crear Lista",-1),A={class:"mb-3"},B=e("label",{for:"nuevoNombre"},"Nombre de la Lista:",-1),P={class:"mb-3"},z=e("label",{for:"equipoSeleccionado"},"Equipo:",-1),G=["value"],I=e("div",{class:"text-center"},[e("button",{type:"submit",class:"btn btn-primary rounded-pill"},"Crear")],-1),H={data(){return{nombre:"",modalVisible:!1,modalCrearVisible:!1,listaSeleccionada:{id_lista:null,nombre:""},equipoSeleccionado:{equipo_id:null,nombre:"",numero_licencia:"",nombre_usuario:""},error:null,user_id:this.user_id,nombreUsuario:"",tipoUsuario:"",nuevoNombre:"",currentListId:Number}},mounted(){n.get("/api/usuario_actual").then(i=>{this.user_id=i.data.user_id,this.nombreUsuario=i.data.nombre,this.tipoUsuario=i.data.tipo_usuario}).catch(i=>{console.error("Error al obtener el usuario actual:",i),i.response&&i.response.status===401?window.location.href="/":this.error="Error al obtener el usuario actual."})},computed:{equiposDisponibles(){return this.tipoUsuario=="Administrador"?this.equipos.filter(i=>i.user_id===this.user_id):this.equipos.filter(i=>i.user_id===this.user_id)}},methods:{filtrarListas(){return this.tipoUsuario=="Administrador"?this.listas.filter(i=>i.equipo.user_id===this.user_id):this.listas.filter(i=>i.equipo.user_id===this.user_id)},abrirModal(i){this.listaSeleccionada={...i},this.modalVisible=!0},cerrarModal(){this.modalVisible=!1,this.listaSeleccionada={id_lista:null,nombre:""},this.error=null},abrirModalCrear(){this.modalCrearVisible=!0,console.log(this.modalCrearVisible),console.log("Tipo usuario",this.tipoUsuario)},cerrarModalCrear(){this.modalCrearVisible=!1,this.nuevoNombre="",this.error=null},eliminarLista(i){n.delete(`/listasDELETE/${i}`,{}).then(()=>{window.location.reload(),alert("Lista eliminada correctamente")}).catch(o=>{console.error("Error al eliminar la lista:",o)})},editarLista(i){n.put(`/listasPUT/${i}`,{nombre:this.listaSeleccionada.nombre}).then(()=>{alert("Lista editada correctamente"),this.cerrarModal(),window.location.reload()}).catch(o=>{console.error("Error al editar la lista:",o)})},crearLista(){n.post("/listasPOST",{nombre:this.nuevoNombre,equipo_id:this.equipoSeleccionado.equipo_id}).then(()=>{alert("Lista creada correctamente"),this.cerrarModalCrear(),window.location.reload()}).catch(i=>{console.error("Error al crear la lista:",i)})},redirectToListaContent(i){this.currentListId=i,window.location.href=`/listas/${i}/multimedia`}}},W=Object.assign(H,{__name:"Listas",props:{listas:Object,equipos:Object},setup(i){return(o,t)=>(r(),a(d,null,[c(v),e("div",L,[q,e("button",{class:"btn morado-btn",onClick:t[0]||(t[0]=(...s)=>o.abrirModalCrear&&o.abrirModalCrear(...s))},"Crear Nueva Lista"),i.listas.length===0?(r(),a("div",k," No hay listas disponibles. ")):(r(),a("div",S,[e("ul",y,[(r(!0),a(d,null,m(o.filtrarListas(),s=>(r(),a("li",{key:s.id_lista},[e("div",N,[e("button",{class:"btn eliminar-btn",onClick:l=>o.redirectToListaContent(s.id_lista)},_(s.nombre),9,M),e("div",V,[e("button",{class:"btn editar-btn",onClick:l=>o.abrirModal(s)},"Editar",8,w),e("button",{class:"btn btn-danger btn-trash bi-trash",onClick:l=>o.eliminarLista(s.id_lista)},null,8,E),o.modalVisible?(r(),a("div",U,[e("div",g,[e("span",{class:"close",onClick:t[1]||(t[1]=(...l)=>o.cerrarModal&&o.cerrarModal(...l))},"×"),T,e("form",{onSubmit:t[3]||(t[3]=b(l=>o.editarLista(o.listaSeleccionada.id_lista),["prevent"]))},[$,u(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=l=>o.listaSeleccionada.nombre=l),id:"nombre",class:"form-control rounded-pill"},null,512),[[p,o.listaSeleccionada.nombre]]),D],32)])])):h("",!0)])])]))),128))])])),o.modalCrearVisible?(r(),a("div",j,[e("div",F,[e("span",{class:"close",onClick:t[4]||(t[4]=(...s)=>o.cerrarModalCrear&&o.cerrarModalCrear(...s))},"×"),O,e("form",{onSubmit:t[7]||(t[7]=b((...s)=>o.crearLista&&o.crearLista(...s),["prevent"]))},[e("div",A,[B,u(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=s=>o.nuevoNombre=s),id:"nuevoNombre",class:"form-control rounded-pill"},null,512),[[p,o.nuevoNombre]])]),e("div",P,[z,u(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.equipoSeleccionado.equipo_id=s),id:"equipoSeleccionado",class:"form-control rounded-pill"},[(r(!0),a(d,null,m(o.equiposDisponibles,s=>(r(),a("option",{value:s.equipo_id,key:s.equipo_id},_(s.nombre),9,G))),128))],512),[[f,o.equipoSeleccionado.equipo_id]])]),I],32)])])):h("",!0)]),c(C)],64))}});export{W as default};
